## @generatedata/config

This is the configuration package for the generatedata script. When initially cloning the repo to use locally, you'll need
to create a couple of config files containing the settings you want.

## How to configure

Make a copy of these two files in the `src/` folder and rename them to remove the "example" part, so:

- `client.config.example.ts` ---> `client.config.ts`
- `server.config.example.ts` ---> `server.config.ts`

These contain the server- and the client-side settings for your installation. They are separate because the `client.config.ts` content **will be bundled in the front-end code** so aren't secure. The `server.config.ts` file content is only loaded by the server and won't be visible to your website visitors in any form.

After you create those two files you'll be able to continue building the app. But before you do - please read over the settings to check it's configuring your application as you'd like. _Most settings can be changed later - you'll just need to do a fresh build_.

### Client-side settings

Alright! Let's look at the content of your newly created `client.config.ts` file. We've explained each setting with a comment.

**Note: you don't need to edit any of these values** but you'll probably want to examine them all to see if there's anything you want changed. Also note that the `GD_APP_TYPE` setting is a _one off_. It's used during the initial installation to set up the database, then not afterwards.

```typescript
import type { GDClientConfig } from '../typings';

const config: GDClientConfig = {
  appSettings: {
    // this setting controls the overall type of the installation. It's used on initial installation only. The options are:
    //    login - allows anonymous access via the browser, but unless the user has logged in they can't save their data sets
    //            or generate more rows than GD_MAX_DEMO_MODE_ROWS at a time
    //    single - there's only ever a single account and that user is logged in by default
    //    open - anyone that has access to the URL can use the application anonymously or create an account
    //    closed - no-one can access it without logging in first
    GD_APP_TYPE: 'login',

    // this allows easy extension for the prod site. On the prod site, the homepage is a splash info page to the tool. For
    // other distributions, that isn't necessary
    GD_GENERATOR_PATH: '/',

    // the default locale for people visiting the app
    GD_DEFAULT_LOCALE: 'en',

    // the default Export Type that's show in the preview panel. The accepted values are any of the folder names of the
    // available Export Types. See the packages/plugins package for that.
    GD_DEFAULT_EXPORT_TYPE: 'JSON',

    // this controls what locales show up in the UI. If you only enter 1, the icon to switch locales won't appear. If you
    // want to add other locales, awesome! PRs welcome :)
    GD_LOCALES: ['ar', 'de', 'en', 'es', 'fr', 'hi', 'ja', 'nl', 'pt', 'ru', 'ta', 'zh'],

    // the default value for the number of rows to generate
    GD_DEFAULT_NUM_ROWS: 100,

    // for `login` appType, this controls how many rows can be generated by anonymous (non-logged in) users
    GD_MAX_DEMO_MODE_ROWS: 1000,

    // any time a user saves a dataset, that change is stored in the database to allow the user to backtrack and see
    // earlier versions of the dataset. This governs the max number of history items
    GD_MAX_DATASET_HISTORY_SIZE: 200,

    // this omits specific Data Types from the application. It omits them from appearing in the UI.
    GD_DATA_TYPE_BLACKLIST: ['BitcoinAddress', 'OrganizationNumber', 'PersonalNumber', 'SIRET'],

    // this omits specific Export Types from the application. It omits them from appearing in the UI.
    GD_EXPORT_TYPE_BLACKLIST: [],

    // omits specific Country plugins from appearing in the application; comma-delimited (no spaces!)
    GD_COUNTRY_BLACKLIST: [],

    // used for extension purposes only. TODO
    GD_IMPORT_FILES: []
  },

  auth: {
    // controls the lifespan of the JWT. Suggest you leave this setting alone
    GD_JWT_LIFESPAN_MINS: 15,

    // if you want to enable the "Login with Google" feature, this contains the google auth client ID
    GD_GOOGLE_AUTH_CLIENT_ID: ''
  },

  api: {
    // the server port for the graphql server
    GD_API_SERVER_PORT: 3001
  },

  webServer: {
    // controls the URL you'll load up in the browser to see the app
    GD_WEB_DOMAIN: 'localhost',

    // the webserver port
    GD_WEB_SERVER_PORT: 9000,

    // https vs http. Runnign `https` locally is always fussy as heck, so leave as false unless strictly necessary
    GD_WEB_USE_HTTPS: false
  }
};

export default config;
```

### Server-side settings

```typescript
import type { GDServerConfig } from '../typings';

const serverConfig: GDServerConfig = {
  auth: {
    // PLEASE UPDATE. JWT secret. This is used for the JWT generation code. It should be changed to any random string
    GD_JWT_SECRET: 'Change this string to anything you like.',

    // PLEASE UPDATE. Any random string is fine
    GD_JWT_REFRESH_TOKEN_SECRET: 'Also change this string to something else.',

    // (optional) Sign-in with Google settings for - oath2. This requires `GD_GOOGLE_AUTH_CLIENT_ID` to have been set in the
    // client.config.ts file
    GD_GOOGLE_AUTH_CLIENT_SECRET: ''
  },

  // (optional) this gives you the optional of tying in email functionality, to enable features like emailing for lost passwords,
  // registering and so on
  email: {
    GD_EMAIL_OAUTH_SERVICE_CLIENT_ID: '',
    GD_EMAIL_OAUTH_PRIVATE_KEY: ''
  },

  // You can either set these values before installing the app, or customize the values via the UI
  // afterwards. This information is only used during the initial setup of the application
  defaultAdminAccount: {
    GD_DEFAULT_ADMIN_FIRST_NAME: 'John',
    GD_DEFAULT_ADMIN_LAST_NAME: 'Smith',
    GD_DEFAULT_ADMIN_EMAIL_SENDER_NAME: 'YourSite',
    GD_DEFAULT_ADMIN_EMAIL: 'admin@youremail.net',
    GD_DEFAULT_ADMIN_PASSWORD: 'admin123'
  }
};

export default serverConfig;
```

## TODO

Needs more documentation on:

- what JWT is
- setting up the email configuration,
- setting up a sign-in with Google
